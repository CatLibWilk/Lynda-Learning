## Chpt. 1 Apache HTTP Server
- a web server needs a static IP address and domain name.
- Apache configuration
    - config files at `etc/apache2`
    - `apache2.conf` is main config file
    - on ubuntu, configuration is broken out into several files:  
        - main config = `apache2.conf`
        - individual site configs = `sites-available` folder
            -  use `a2ensite` and `a2dissite` to enable/disable sites
- Apache Directives
    - used in .conf file to determine how the server or hosts function
    - common sections
        - <VirtualHost> = defines a virtualhost
        - <IfModule> = tests for presence of module
        - <FilesMatch> = tells system to reach in certain way in response to requests for files matching a certain regex or condition
            - often used as handler for a particular type of file
        - <Directory> = sets parameters for given directory on server
            - inside will frequently include directives like Options, AllowOverride, Require, etc.
    - common directives
        - `Options`: sets parameter that a directory will be allowed to support 
        - `AllowOverride`: set features that can be overridden by later configurations like htaccess
        - `Require`: allow views to access/not access a given folder
        - `Include`: loads another file
        - `DocumentRoot`: root folder that apache will serve up
    - Name-based VirtualHosts
        - allows several websites to have the same IP address
        - setup:
            - at `etc/apache2/sites-available`, copy `000-default.conf and rename for your site
            - set `ServerName` to match the domain that will point to the IP address
            - set `DocumentRoot` for directory that apache should serve
            - run cmd `a2ensite [conf_file_name]` and `service apache2 reload`
## Chpt. 2 Adding Encryption with HTTPS
- HTTPS uses TLS (Transport Layer Security to encrypt communication between client and server)
    - require certificate
        - carry information about server and what organization has "signed" it, ie.  what entity has "vouched" for it.
    - configuration
        - `/etc/apache2/sites-available/default-ssl.conf` is template VirtualHost for setting up ssl
            - need to set `ServerName` as directory (will add)
            - `SSLEngine` must be set to `on`
            - set paths for certificate and private key with `SSLCertificateFile` and `SSLCertificateKeyFile`
- creating a self-signed certicate (cert that doesnt provide a trust relationship)
    - self-signed certs provide encryption but dont verify identity.
    - DO NOT USE IN PRODUCTION
    - generation command:
        - openssl req -x509  
        -newkey rsa:2048  
        -keyout mycert.key  
        -out mycert.pem  
        -node  #no DES: no password  
        -days 365  
    - key (file.key) will go somewhere like `/etc/ssl/private`, cert (file.pem) `/etc/ssl/certs`
    - run `a2enmod` and `a2ensite` for the ssl module
- using a cert from a cert authority
    - name on cert must match domain name
        - can get separate ones for each domain and subdomain, a SAN cert that covers a list of subdomains, or a `wildcard` cert that covers all subdomains of a domain
- making access easier
    - typed addresses need to be handled, by default https://website.com, http://website.com, http://www.website.com, and https://www.website.com are 4 different sites, only the first two will work by default

    - handling `www`
        - need server alias, so that regardless of `www` inclusion the server handles correctly
        - at `/etc/apache2/sites-available/default-ssl.conf` (or non-ssl if thats whats used):
            - add `ServerAlias` in Vhost block, eg. `ServerAlias www.mywebsite.com`
        - redirect HTTP to HTTPS
            - open conf for non-secure vhost `/etc/apache2/sites-available/000-default.conf`
            -  in addition to `ServerName` and `ServerAlias`, add `Redirect` to vhost block
                - eg. `Redirect permanent / https://www.mywebsite.com`
    - DNS support for WWW
        - need to create DNS record of type `CNAME` with your domain provider
## Chpt. 3 Administering Apache Server